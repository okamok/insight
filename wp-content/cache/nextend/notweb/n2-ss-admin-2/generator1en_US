[[{"id":2240,"url":"http:\/\/192.168.99.100:8000\/?p=2240","title":"Docker\u3067Ruby On Rails + Nginx + Unicorn + MySQL\u306e\u74b0\u5883\u3092\u4f5c\u308b","content":"docker-compose\u3067web\u7528\u3001db\u7528\u306e2\u3064\u306e\u30b3\u30f3\u30c6\u30ca\u30fc\u3092\u4f5c\u6210\u3057\u3066\u4e00\u62ec\u7ba1\u7406\u3067\u304d\u308b\u72b6\u614b\u3092\u30b4\u30fc\u30eb\u3068\u3057\u307e\u3059\u3002\r\n\u30db\u30b9\u30c8PC\u306b\u306fRails\u3082Nginx\u306a\u3069\u4f55\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u3044\u3067\u958b\u767a\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\u3002\r\n\r\n<h3 class=\"postTitle\">\u524d\u63d0\u74b0\u5883<\/h3>\r\n\u30fbmac OS X 10.9.5\r\n\u30fbdocker-compose \u3092\u4f7f\u3048\u308b\u3002\r\n\u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30eb\u30fc\u30c8\u306f\u300c\/Users\/user\/develop\/docker_rails\u300d\u3068\u3057\u307e\u3059\u3002\r\n\u4ee5\u4e0b\u3001\u9069\u5b9c\u8aad\u307f\u66ff\u3048\u3066\u4e0b\u3055\u3044\u3002\r\n\r\n<h3 class=\"postTitle\">\u69cb\u7bc9\u624b\u9806<\/h3>\r\n<h4 class=\"postTitleSmall\">1.\u4e0b\u8a18\uff15\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6e96\u5099<\/h4>\r\nGemfile\r\n<pre class=\"code\">\r\nsource 'https:\/\/rubygems.org'\r\ngem 'rails'\r\n<\/pre>\r\n\r\nGemfile.lock\r\n<pre class=\"code\">\r\n\u7a7a\u3067OK\r\n<\/pre>\r\n\r\nDockerfile\r\n<pre class=\"code\">\r\nFROM rails:4.2.6\r\nENV LANG C.UTF-8\r\n\r\n# nginx,vim \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\r\nRUN apt-get update && apt-get install -y build-essential libpq-dev nodejs vim nginx\r\n\r\n# nginx \u306b unicorn\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\r\nADD .\/container\/nginx\/unicorn.conf \/etc\/nginx\/conf.d\/unicorn.conf\r\n\r\n# Gemfile bundle install\r\nWORKDIR \/tmp\r\nADD Gemfile Gemfile\r\nADD Gemfile.lock Gemfile.lock\r\nRUN bundle install\r\n\r\nENV APP_HOME \/var\/www\/docker_rails\r\nRUN mkdir -p $APP_HOME\r\nWORKDIR $APP_HOME\r\nADD . $APP_HOME\r\n<\/pre>\r\n\r\n\r\ndocker-compose.yml\r\n<pre class=\"code\">\r\nversion: '2'\r\nservices:\r\n  db:\r\n    image: mysql\r\n    ports:\r\n      - \"3306:3306\"\r\n    environment:\r\n      MYSQL_ROOT_PASSWORD: password\r\n    privileged: true\r\n  web:\r\n    build: .\r\n    command: \/bin\/bash -c \"nginx && bundle exec unicorn -c config\/unicorn.rb -D && while true; do sleep 10000; done\"\r\n    volumes:\r\n      - .:\/var\/www\/docker_rails\r\n    ports:\r\n      - \"80:80\"\r\n    depends_on:\r\n      - db\r\n    privileged: true\r\n<\/pre>\r\n\r\ncontainer\/nginx\/unicorn.conf\r\n<pre class=\"code\">\r\nupstream unicorn {\r\n  server unix:\/var\/www\/unicorn.sock fail_timeout=0;\r\n}\r\n\r\nserver {\r\n  listen 80;\r\n  server_name 192.168.99.100;\r\n\r\n  root \/var\/www\/docker_rails\/public;\r\n\r\n  try_files $uri @unicorn;\r\n\r\n  location @unicorn {\r\n    proxy_set_header Host $http_host;\r\n    proxy_pass http:\/\/unicorn;\r\n  }\r\n}\r\n<\/pre>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">2.rails new \u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002<\/h4>\r\n<pre class=\"console\" style=\"margin-top:10px\">\r\n$ docker-compose run web rails new . --force --database=mysql --skip-bundle\r\n<\/pre>\r\n\r\ndocker\u30b3\u30f3\u30c6\u30ca\u30fc\u5185\u306bRails\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u30db\u30b9\u30c8PC\u306b\u30b3\u30d4\u30fc\u3055\u308c\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\r\n\r\n\r\n<h4 class=\"postTitleSmall\">3.docker-compose run \u3067\u4f5c\u3063\u305f\u30b3\u30f3\u30c6\u30ca\u30fc\/\u30a4\u30e1\u30fc\u30b8\u3092\u524a\u9664<\/h4>\r\n3\u3067docker-compose run \u3092\u884c\u3063\u305f\u306e\u306f\u30db\u30b9\u30c8PC\u306brails new\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u4e8b\u304c\u76ee\u7684\u3060\u3063\u305f\u306e\u3067\u3001\u88fd\u9020\u3055\u308c\u305fimage\u3068container\u306f\u524a\u9664\u3057\u307e\u3059\u3002\r\n\r\n<h4 class=\"postTitleSmall\">4.\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63<\/h4>\r\n\r\nGemfile \r\n\u4e00\u756a\u4e0b\u306e\u4e0b\u8a182\u884c\u3092\u8ffd\u8a18\r\n<pre class=\"code\">\r\ngem 'unicorn'\r\ngem 'therubyracer', platforms: :ruby\r\n<\/pre>\r\n\r\nconfig\/database.yml \r\npassword,host\u3092\u4fee\u6b63\r\n<pre class=\"code\">\r\ndefault: &default\r\n  adapter: mysql2\r\n  encoding: utf8\r\n  pool: 5\r\n  username: root\r\n  password: password\r\n  host: db\r\n\r\ndevelopment:\r\n  <<: *default\r\n  database: docker_rails_development\r\n\r\ntest:\r\n  <<: *default\r\n  database: docker_rails_test\r\n\r\nproduction:\r\n  <<: *default\r\n  database: docker_rails_production\r\n  username: docker_rails\r\n  password: <%= ENV['DOCKER_RAILS_DATABASE_PASSWORD'] %>\r\n<\/pre>\r\n\r\nconfig\/unicorn.rb \r\n\u4e0b\u8a18\u5185\u5bb9\u3067\u4f5c\u6210\r\n<pre class=\"code\">\r\npid '\/var\/www\/docker_rails\/tmp\/unicorn.pid'\r\nlisten '\/var\/www\/unicorn.sock'\r\nstderr_path '\/var\/www\/docker_rails\/log\/unicorn.log'\r\nstdout_path '\/var\/www\/docker_rails\/log\/unicorn.log'\r\nworker_processes 2\r\ntimeout 30\r\n<\/pre>\t\r\n\r\n<h4 class=\"postTitleSmall\">5.\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067image\u3092\u4f5c\u6210<\/h4>\r\n<pre class=\"console\" style=\"margin-top:10px\">\r\n$ docker-compose build\r\n<\/pre>\t\r\n\r\n<p>\r\nweb\u7528\u3001db\u75282\u3064\u306eimage\u304c\u4f5c\u6210\u3055\u308c\u305f\u304b\u78ba\u8a8d\r\n<pre class=\"console\">\r\n$ docker images\r\n<\/pre>\t\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\" style=\"margin-top:15px\" >6.\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067image\u304b\u3089container\u3092\u4f5c\u6210<\/h4>\r\n<pre class=\"console\" style=\"margin-top:10px\">\r\ndocker-compose up\r\n<\/pre>\t\r\n\r\n\u203bweb\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\u7acb\u3061\u4e0a\u304c\u3089\u306a\u3044\u6642\u306f\/tmp\/unicorn.pid \u3092\u524a\u9664\u3059\u308b\r\n\r\n<h4 class=\"postTitleSmall\">7.docker-compose up \u304c\u9014\u4e2d\u3067\u6b62\u307e\u308b\u306e\u3067\u30bf\u30fc\u30df\u30ca\u30eb\u306e\u5225\u30bf\u30d6\u304b\u3089DB\u3092\u4f5c\u6210<\/h4>\r\n\r\nweb\u7528\u3001db\u75282\u3064\u306econtainer\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u78ba\u8a8d\r\n<pre class=\"console\">\r\n$ docker ps\r\n<\/pre>\r\n\r\n\u52d5\u3044\u3066\u3044\u306a\u3044\u5834\u5408\u306fcontainer ID\u3092\u8abf\u3079\u308b\r\n<pre class=\"console\">\r\n$ docker ps\u3000-a\r\n<\/pre>\r\n\r\ncontainer\u3092\u8d77\u52d5\u3059\u308b\u3002\r\n<pre class=\"console\">\r\n$ docker start\u3000{container ID}\r\n<\/pre>\r\n\r\n\r\nweb\u306econtainer\u306b\u30ed\u30b0\u30a4\u30f3\r\n<pre class=\"console\">\r\ndocker exec -it {web\u306econtainer ID} \/bin\/bash\r\n<\/pre>\r\n\r\n<p>\r\n\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067DB\u3092\u4f5c\u6210\r\n<pre class=\"console\">\r\nrake db:create\r\n<\/pre>\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\">8.\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9<\/h4>\r\n\u30db\u30b9\u30c8PC\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u4e0b\u8a18\u3067IP\u3092\u78ba\u8a8d\r\n<pre class=\"console\">\r\n\uff04 docker-machine ip\r\n<\/pre>\r\n\r\n\u4e0b\u8a18URL\u3067\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\r\nhttp:\/\/{ip}\r\n\r\nRAILS\u306ehome\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002","description":"docker-compose\u3067web\u7528\u3001db\u7528\u306e2\u3064\u306e\u30b3\u30f3\u30c6\u30ca\u30fc\u3092\u4f5c\u6210\u3057\u3066\u4e00\u62ec\u7ba1\u7406\u3067\u304d\u308b\u72b6\u614b\u3092\u30b4\u30fc\u30eb\u3068\u3057\u307e\u3059\u3002\r\n\u30db\u30b9\u30c8PC\u306b\u306fRails\u3082Nginx\u306a\u3069\u4f55\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u3044\u3067\u958b\u767a\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\u3002\r\n\r\n<h3 class=\"postTitle\">\u524d\u63d0\u74b0\u5883<\/h3>\r\n\u30fbmac OS X 10.9.5\r\n\u30fbdocker-compose \u3092\u4f7f\u3048\u308b\u3002\r\n\u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30eb\u30fc\u30c8\u306f\u300c\/Users\/user\/develop\/docker_rails\u300d\u3068\u3057\u307e\u3059\u3002\r\n\u4ee5\u4e0b\u3001\u9069\u5b9c\u8aad\u307f\u66ff\u3048\u3066\u4e0b\u3055\u3044\u3002\r\n\r\n<h3 class=\"postTitle\">\u69cb\u7bc9\u624b\u9806<\/h3>\r\n<h4 class=\"postTitleSmall\">1.\u4e0b\u8a18\uff15\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6e96\u5099<\/h4>\r\nGemfile\r\n<pre class=\"code\">\r\nsource 'https:\/\/rubygems.org'\r\ngem 'rails'\r\n<\/pre>\r\n\r\nGemfile.lock\r\n<pre class=\"code\">\r\n\u7a7a\u3067OK\r\n<\/pre>\r\n\r\nDockerfile\r\n<pre class=\"code\">\r\nFROM rails:4.2.6\r\nENV LANG C.UTF-8\r\n\r\n# nginx,vim \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\r\nRUN apt-get update && apt-get install -y build-essential libpq-dev nodejs vim nginx\r\n\r\n# nginx \u306b unicorn\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\r\nADD .\/container\/nginx\/unicorn.conf \/etc\/nginx\/conf.d\/unicorn.conf\r\n\r\n# Gemfile bundle install\r\nWORKDIR \/tmp\r\nADD Gemfile Gemfile\r\nADD Gemfile.lock Gemfile.lock\r\nRUN bundle install\r\n\r\nENV APP_HOME \/var\/www\/docker_rails\r\nRUN mkdir -p $APP_HOME\r\nWORKDIR $APP_HOME\r\nADD . $APP_HOME\r\n<\/pre>\r\n\r\n\r\ndocker-compose.yml\r\n<pre class=\"code\">\r\nversion: '2'\r\nservices:\r\n  db:\r\n    image: mysql\r\n    ports:\r\n      - \"3306:3306\"\r\n    environment:\r\n      MYSQL_ROOT_PASSWORD: password\r\n    privileged: true\r\n  web:\r\n    build: .\r\n    command: \/bin\/bash -c \"nginx && bundle exec unicorn -c config\/unicorn.rb -D && while true; do sleep 10000; done\"\r\n    volumes:\r\n      - .:\/var\/www\/docker_rails\r\n    ports:\r\n      - \"80:80\"\r\n    depends_on:\r\n      - db\r\n    privileged: true\r\n<\/pre>\r\n\r\ncontainer\/nginx\/unicorn.conf\r\n<pre class=\"code\">\r\nupstream unicorn {\r\n  server unix:\/var\/www\/unicorn.sock fail_timeout=0;\r\n}\r\n\r\nserver {\r\n  listen 80;\r\n  server_name 192.168.99.100;\r\n\r\n  root \/var\/www\/docker_rails\/public;\r\n\r\n  try_files $uri @unicorn;\r\n\r\n  location @unicorn {\r\n    proxy_set_header Host $http_host;\r\n    proxy_pass http:\/\/unicorn;\r\n  }\r\n}\r\n<\/pre>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">2.rails new \u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002<\/h4>\r\n<pre class=\"console\" style=\"margin-top:10px\">\r\n$ docker-compose run web rails new . --force --database=mysql --skip-bundle\r\n<\/pre>\r\n\r\ndocker\u30b3\u30f3\u30c6\u30ca\u30fc\u5185\u306bRails\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u30db\u30b9\u30c8PC\u306b\u30b3\u30d4\u30fc\u3055\u308c\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\r\n\r\n\r\n<h4 class=\"postTitleSmall\">3.docker-compose run \u3067\u4f5c\u3063\u305f\u30b3\u30f3\u30c6\u30ca\u30fc\/\u30a4\u30e1\u30fc\u30b8\u3092\u524a\u9664<\/h4>\r\n3\u3067docker-compose run \u3092\u884c\u3063\u305f\u306e\u306f\u30db\u30b9\u30c8PC\u306brails new\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u4e8b\u304c\u76ee\u7684\u3060\u3063\u305f\u306e\u3067\u3001\u88fd\u9020\u3055\u308c\u305fimage\u3068container\u306f\u524a\u9664\u3057\u307e\u3059\u3002\r\n\r\n<h4 class=\"postTitleSmall\">4.\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63<\/h4>\r\n\r\nGemfile \r\n\u4e00\u756a\u4e0b\u306e\u4e0b\u8a182\u884c\u3092\u8ffd\u8a18\r\n<pre class=\"code\">\r\ngem 'unicorn'\r\ngem 'therubyracer', platforms: :ruby\r\n<\/pre>\r\n\r\nconfig\/database.yml \r\npassword,host\u3092\u4fee\u6b63\r\n<pre class=\"code\">\r\ndefault: &default\r\n  adapter: mysql2\r\n  encoding: utf8\r\n  pool: 5\r\n  username: root\r\n  password: password\r\n  host: db\r\n\r\ndevelopment:\r\n  <<: *default\r\n  database: docker_rails_development\r\n\r\ntest:\r\n  <<: *default\r\n  database: docker_rails_test\r\n\r\nproduction:\r\n  <<: *default\r\n  database: docker_rails_production\r\n  username: docker_rails\r\n  password: <%= ENV['DOCKER_RAILS_DATABASE_PASSWORD'] %>\r\n<\/pre>\r\n\r\nconfig\/unicorn.rb \r\n\u4e0b\u8a18\u5185\u5bb9\u3067\u4f5c\u6210\r\n<pre class=\"code\">\r\npid '\/var\/www\/docker_rails\/tmp\/unicorn.pid'\r\nlisten '\/var\/www\/unicorn.sock'\r\nstderr_path '\/var\/www\/docker_rails\/log\/unicorn.log'\r\nstdout_path '\/var\/www\/docker_rails\/log\/unicorn.log'\r\nworker_processes 2\r\ntimeout 30\r\n<\/pre>\t\r\n\r\n<h4 class=\"postTitleSmall\">5.\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067image\u3092\u4f5c\u6210<\/h4>\r\n<pre class=\"console\" style=\"margin-top:10px\">\r\n$ docker-compose build\r\n<\/pre>\t\r\n\r\n<p>\r\nweb\u7528\u3001db\u75282\u3064\u306eimage\u304c\u4f5c\u6210\u3055\u308c\u305f\u304b\u78ba\u8a8d\r\n<pre class=\"console\">\r\n$ docker images\r\n<\/pre>\t\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\" style=\"margin-top:15px\" >6.\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067image\u304b\u3089container\u3092\u4f5c\u6210<\/h4>\r\n<pre class=\"console\" style=\"margin-top:10px\">\r\ndocker-compose up\r\n<\/pre>\t\r\n\r\n\u203bweb\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\u7acb\u3061\u4e0a\u304c\u3089\u306a\u3044\u6642\u306f\/tmp\/unicorn.pid \u3092\u524a\u9664\u3059\u308b\r\n\r\n<h4 class=\"postTitleSmall\">7.docker-compose up \u304c\u9014\u4e2d\u3067\u6b62\u307e\u308b\u306e\u3067\u30bf\u30fc\u30df\u30ca\u30eb\u306e\u5225\u30bf\u30d6\u304b\u3089DB\u3092\u4f5c\u6210<\/h4>\r\n\r\nweb\u7528\u3001db\u75282\u3064\u306econtainer\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u78ba\u8a8d\r\n<pre class=\"console\">\r\n$ docker ps\r\n<\/pre>\r\n\r\n\u52d5\u3044\u3066\u3044\u306a\u3044\u5834\u5408\u306fcontainer ID\u3092\u8abf\u3079\u308b\r\n<pre class=\"console\">\r\n$ docker ps\u3000-a\r\n<\/pre>\r\n\r\ncontainer\u3092\u8d77\u52d5\u3059\u308b\u3002\r\n<pre class=\"console\">\r\n$ docker start\u3000{container ID}\r\n<\/pre>\r\n\r\n\r\nweb\u306econtainer\u306b\u30ed\u30b0\u30a4\u30f3\r\n<pre class=\"console\">\r\ndocker exec -it {web\u306econtainer ID} \/bin\/bash\r\n<\/pre>\r\n\r\n<p>\r\n\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067DB\u3092\u4f5c\u6210\r\n<pre class=\"console\">\r\nrake db:create\r\n<\/pre>\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\">8.\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9<\/h4>\r\n\u30db\u30b9\u30c8PC\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u4e0b\u8a18\u3067IP\u3092\u78ba\u8a8d\r\n<pre class=\"console\">\r\n\uff04 docker-machine ip\r\n<\/pre>\r\n\r\n\u4e0b\u8a18URL\u3067\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\r\nhttp:\/\/{ip}\r\n\r\nRAILS\u306ehome\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002","author":"admin","author_name":"admin","author_url":"","date":"December 16, 2016","excerpt":"docker-compose\u3067web\u7528\u3001db\u7528\u306e2\u3064\u306e\u30b3\u30f3\u30c6\u30ca\u30fc\u3092\u4f5c\u6210\u3057\u3066\u4e00\u62ec\u7ba1\u7406\u3067\u304d\u308b\u72b6\u614b\u3092\u30b4\u30fc\u30eb\u3068\u3057\u307e\u3059\u3002 \u30db\u30b9\u30c8PC\u306b\u306fRails\u3082Nginx\u306a\u3069\u4f55\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u3044\u3067\u958b\u767a\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\u3002 \u524d\u63d0\u74b0\u5883 \u30fbmac OS X 10.9.5 \u30fbdocker-compose \u3092\u4f7f\u3048\u308b\u3002 \u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30eb\u30fc\u30c8\u306f\u300c\/Users\/user\/develop\/docker_rails\u300d\u3068\u3057\u307e\u3059\u3002 \u4ee5\u4e0b\u3001\u9069\u5b9c\u8aad\u307f\u66ff\u3048\u3066\u4e0b\u3055\u3044\u3002 \u69cb\u7bc9\u624b\u9806 1.\u4e0b\u8a18\uff15\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6e96\u5099 Gemfile source 'https:\/\/rubygems.org' gem 'rails' Gemfile.lock \u7a7a\u3067OK Dockerfile FROM rails:4.2.6 ENV LANG C.UTF-8 # nginx,vim \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb RUN apt-get update && apt-get install -y build-essential libpq-dev nodejs vim nginx # nginx \u306b unicorn\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc ADD .\/container\/nginx\/unicorn.conf \/etc\/nginx\/conf.d\/unicorn.conf # Gemfile bundle install WORKDIR \/tmp ADD [&hellip;]","modified":"December 30, 2016","category_name":"Develop","category_link":"http:\/\/192.168.99.100:8000\/?cat=147","category_name_0":"Develop","category_link_0":"http:\/\/192.168.99.100:8000\/?cat=147","category_name_1":"Featured","category_link_1":"http:\/\/192.168.99.100:8000\/?cat=3","category_name_2":"Ruby on Rails","category_link_2":"http:\/\/192.168.99.100:8000\/?cat=151","featured_image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V.jpg","image_thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-150x150.jpg","image_medium":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-300x200.jpg","image_medium_large":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-768x512.jpg","image_large":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-1024x682.jpg","image_newsmag-single-post":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-730x330.jpg","image_newsmag-recent-post-big":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-560x416.jpg","image_newsmag-post-horizontal":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-350x260.jpg","image_newsmag-vertical-post":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-255x195.jpg","image_newsmag-post-grid":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-360x270.jpg","image_newsmag-post-grid-small":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-275x210.jpg","image_newsmag-recent-post-list-image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-65x65.jpg","image_newsmag-slider-image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-1600x600.jpg","image_wp_rp_thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V-150x150.jpg","image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V.jpg","thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/gori0I9A3129072103951_TP_V.jpg","url_label":"View post","tag_1":"docker","tag_2":"MySQL","tag_3":"Nginx","tag_4":"Unicorn"}],[{"id":2237,"url":"http:\/\/192.168.99.100:8000\/?p=2237","title":"CakePHP3 \u5165\u9580","content":"","description":"","author":"admin","author_name":"admin","author_url":"","date":"December 16, 2016","excerpt":"","modified":"December 16, 2016","category_name":"CakePHP","category_link":"http:\/\/192.168.99.100:8000\/?cat=148","category_name_0":"CakePHP","category_link_0":"http:\/\/192.168.99.100:8000\/?cat=148","category_name_1":"Develop","category_link_1":"http:\/\/192.168.99.100:8000\/?cat=147","category_name_2":"Featured","category_link_2":"http:\/\/192.168.99.100:8000\/?cat=3","featured_image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V.jpg","image_thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-150x150.jpg","image_medium":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-300x190.jpg","image_medium_large":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-768x487.jpg","image_large":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-1024x650.jpg","image_newsmag-single-post":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-730x330.jpg","image_newsmag-recent-post-big":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-560x416.jpg","image_newsmag-post-horizontal":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-350x260.jpg","image_newsmag-vertical-post":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-255x195.jpg","image_newsmag-post-grid":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-360x270.jpg","image_newsmag-post-grid-small":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-275x210.jpg","image_newsmag-recent-post-list-image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-65x65.jpg","image_newsmag-slider-image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-1600x600.jpg","image_wp_rp_thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V-150x150.jpg","image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V.jpg","thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/PAK_koi9V9A6859_TP_V.jpg","url_label":"View post","tag_1":"","tag_2":"","tag_3":"","tag_4":""}],[{"id":2198,"url":"http:\/\/192.168.99.100:8000\/?p=2198","title":"Docker\u3067WordPress\u306e\u958b\u767a\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b","content":"Docker\u3067WordPress\u5b9f\u884c\u74b0\u5883\u3092\u69cb\u7bc9\u3001\u901a\u5e38\u306e\u958b\u767a\u304c\u51fa\u6765\u308b\u72b6\u614b\u3092\u30b4\u30fc\u30eb\u3068\u3057\u307e\u3059\u3002\r\n\uff08Docker\u306e\u57fa\u790e\u77e5\u8b58\u306b\u95a2\u3057\u3066\u306f<a href=\"https:\/\/www.ogis-ri.co.jp\/otc\/hiroba\/technical\/docker\/part1.html\">\u30b3\u30c1\u30e9<\/a>\u306e\u30b5\u30a4\u30c8\u304c\u5206\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\uff09\r\n\r\nDocker\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u306f\u3058\u3081\u3044\u304f\u3064\u304b\u540c\u3058\u3088\u3046\u306a\u4e8b\u3092\u89e3\u8aac\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u304c\u3042\u308a\u307e\u3057\u305f\u304c\u3001\u500b\u4eba\u7684\u306b\u4e0b\u8a18\u306e\u70b9\u304c\u8db3\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\r\n\r\n\u30fb<span class=\"marker_water\">\u753b\u50cf(Media)\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u51fa\u6765\u306a\u3044\u3002<\/span>\r\n\r\n\u30fb<span class=\"marker_water\">PhpMyAdmin\u306a\u3069\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u3067DB(MySQL)\u306b\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u3002\r\n\r\n\u30fb<span class=\"marker_water\">\u30d5\u30a1\u30a4\u30eb\u540c\u671f\u51fa\u6765\u306a\u3044<\/span>(\u30db\u30b9\u30c8PC(\u672c\u4f53)\u3068\u30b2\u30b9\u30c8PC(Docker container)\u3067\u30de\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u304c\u51fa\u6765\u3066\u3044\u306a\u3044\u3002)\r\n\r\n\u3053\u308c\u3089\u304c\u30af\u30ea\u30a2\u30fc\u51fa\u6765\u3066\u3044\u306a\u3044\u3068\u958b\u767a\/\u904b\u7528\u306b\u652f\u969c\u304c\u3042\u308b\u306e\u3067\u8272\u3005\u8abf\u3079\u305f\u7d50\u679c\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\r\n\r\n<h3 class=\"postTitle\">\u524d\u63d0\u74b0\u5883<\/h3>\r\n\u30fbmac OS X 10.9.5\r\n\u30fbdocker-compose \u3092\u4f7f\u3048\u308b\u3002\r\n\r\n<h3 class=\"postTitle\">\u69cb\u7bc9\u624b\u9806<\/h3>\r\n<h4 class=\"postTitleSmall\">1.\u30d7\u30ed\u30b8\u30a7\u30af\u30c8 \u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3002<\/h4>\r\n<p>\r\n\u4eca\u56de\u306f\u4e0b\u8a18\u306e\u30d1\u30b9\u306b\u300cdocker_wp\u300d\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3002\r\n\/Users\/user\/develop\/docker_wp\/\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\">2.\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u79fb\u52d5<\/h4>\r\n<p>\r\n<pre class=\"console\">\r\n> cd \/Users\/user\/develop\/docker_wp\/\r\n<\/pre>\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\">3.\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u306e\u3042\u308bWordPress\u7528Docker image \u3092\u4f5c\u6210<\/h4>\r\n<span class=\"marker_water\">(\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u884c\u3046\u4e8b\u3067Media\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002)<\/span>\r\n\r\n\u30fb\u4e0b\u8a18\u5185\u5bb9\u3067Dockerfile\u3092\u4f5c\u6210\u3002\r\n<pre class=\"code\">\r\nFROM wordpress:latest\r\n\r\nRUN usermod -u 1000 www-data \\\r\n    && groupmod -g 1000 www-data\r\n<\/pre>\r\n\u300cFROM wordpress:latest\u300d\u3068\u3057\u3066\u6700\u65b0\u306eWordPress\u7528image\u3092\u5143\u306b\u3057\u3066\u3044\u307e\u3059\u3002\r\n\r\n\u30fb\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067image\u3092\u4f5c\u6210\r\n<pre class=\"console\">\r\ndocker build -t wordpress:auth .\r\n<\/pre>\r\n\u300cwordpress:auth\u300d\u3067image\u306e\u540d\u524d\u3068\u30bf\u30b0\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\r\n\r\n\u5b9f\u884c\u5f8c\u300cdocker images\u300d\u30b3\u30de\u30f3\u30c9\u3067\u6b63\u5e38\u306bimage\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\r\n\r\n<h4 class=\"postTitleSmall\">4.\u4e0b\u8a18\u5185\u5bb9\u3067docker-compose.yml \u3092\u4f5c\u6210\u3002<\/h4>\r\n\r\n<pre class=\"code\">\r\nversion: '2'\r\n\r\nservices:\r\n   db:\r\n     image: mysql:5.7\r\n     <span style=\"color:red\">ports:\r\n       - \"3306:3306\"<\/span>     \r\n     volumes:\r\n       - db_data:\/var\/lib\/mysql\r\n     restart: always\r\n     environment:\r\n       MYSQL_ROOT_PASSWORD: wordpress\r\n       MYSQL_DATABASE: wordpress\r\n       MYSQL_USER: wordpress\r\n       MYSQL_PASSWORD: wordpress\r\n     privileged: true\r\n\r\n   wordpress:\r\n     depends_on:\r\n       - db\r\n     image: wordpress:auth\r\n     ports:\r\n       - \"80:80\"\r\n     restart: always\r\n     working_dir: \/var\/www\/html\r\n     <span style=\"color:red\">volumes:\r\n       - \/Users\/user\/develop\/docker_wp\/:\/var\/www\/html\/<\/span>\r\n     environment:\r\n       WORDPRESS_DB_HOST: db:3306\r\n       WORDPRESS_DB_PASSWORD: wordpress\r\n     privileged: true\r\nvolumes:\r\n    db_data:\r\n<\/pre>\r\n\r\n\u8d64\u5b57\u306e\u90e8\u5206\u306b\u6ce8\u76ee\u3057\u3066\u9802\u304d\u305f\u3044\u306e\u3067\u3059\u304cdb\u306eport\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3067<span class=\"marker_water\">PhpMyAdmin\u306a\u3069\u306e\u5916\u90e8\u304b\u3089\u306e\u63a5\u7d9a\u304c\u53ef\u80fd<\/span>\u306b\u306a\u308a\u307e\u3059\u3002\r\n\u307e\u305fDB\u306evolumes\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3067<span class=\"marker_water\">\u30db\u30b9\u30c8PC\uff08mac\uff09\u3068docker\u30b3\u30f3\u30c6\u30ca\u30fc\u9593\u306e\u30d5\u30a1\u30a4\u30eb\u540c\u671f\u304c\u53ef\u80fd<\/span>\u3068\u306a\u308a\u307e\u3059\u3002\r\n\r\n<h4 class=\"postTitleSmall\">5.\u30b3\u30f3\u30c6\u30ca\u30fc\u4f5c\u6210\u301c\u7a3c\u50cd<\/h4>\r\n<p>\r\n<pre class=\"console\">\r\ndocker-compose up -d\r\n<\/pre>\r\n\r\n\u5b8c\u4e86\u5f8c\u3001\u300cdocker ps\u300d\u306b\u3066\u4f5c\u6210\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\r\n\u3053\u306e\u3088\u3046\u306b2\u3064\u306e\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\u8d77\u52d5\u3057\u3066\u3044\u308c\u3070OK\u3067\u3059\u3002\r\n\r\n<pre class=\"console\">\r\n>docker ps\r\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES\r\n5a9d3770ee0d        wordpress:auth      \"docker-entrypoint.sh\"   3 minutes ago       Up 3 seconds        0.0.0.0:80->80\/tcp       dockerwp_wordpress_1\r\n3980a9064e38        mysql:5.7           \"docker-entrypoint.sh\"   3 minutes ago       Up 5 seconds        0.0.0.0:3306->3306\/tcp   dockerwp_db_1\r\n<\/pre>\r\n<\/p>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">6.\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b<\/h4>\r\n<p>\r\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u63a5\u7d9a\u5148\u306eIP\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\r\n<pre class=\"console\">\r\ndocker-machine ip\r\n<\/pre>\r\n\r\nhttp:\/\/{IP} \r\nwordpress\u306e\u8a2d\u5b9a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\r\n<img src=\"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/wp-300x199.png\" alt=\"wp\" width=\"300\" height=\"199\" class=\"alignnone size-medium wp-image-2227\" \/>\r\n\r\n<\/p>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">7.DB\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b<\/h4>\r\n\u4eca\u56de\u306fSequel Pro\u3067\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\r\n\r\n<img src=\"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/sequel_pro-300x224.png\" alt=\"sequel_pro\" width=\"300\" height=\"224\" class=\"alignnone size-medium wp-image-2228\" \/>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">8.\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7<\/h4>\r\n<p>\r\n\u958b\u767a\u304c\u5b8c\u4e86\u3057\u305f\u6642\u306a\u3069Docker\u3092\u7d42\u4e86\u3059\u308b\u6642\u306f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u30b3\u30f3\u30c6\u30ca\u30fc\u3092\u524a\u9664\u3057\u307e\u3059\u3002\r\n<pre class=\"console\">\r\ndocker-compose down\r\n<\/pre>\r\n\r\n\u30b3\u30f3\u30c6\u30ca\u30fc\u3092\u524a\u9664\u3057\u3066\u3082DB\u30c7\u30fc\u30bf\u306f\u6b8b\u3063\u3066\u3044\u307e\u3059\u3002\r\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067DB\u30c7\u30fc\u30bf\u3082\u5168\u3066\u524a\u9664\u53ef\u80fd\u3067\u3059\u3002\r\n<pre class=\"console\">\r\ndocker-compose down --volumes\r\n<\/pre>\r\n<\/p>\r\n\r\n\r\n\r\n\r\n<\u53c2\u8003\u30b5\u30a4\u30c8>\r\n<a href=\"https:\/\/docs.docker.com\/compose\/wordpress\/\">https:\/\/docs.docker.com\/compose\/wordpress\/<\/a>\r\n\r\n<a href=\"http:\/\/qiita.com\/suin\/items\/3a0361102af83d0b69aa\">http:\/\/qiita.com\/suin\/items\/3a0361102af83d0b69aa<\/a>","description":"Docker\u3067WordPress\u5b9f\u884c\u74b0\u5883\u3092\u69cb\u7bc9\u3001\u901a\u5e38\u306e\u958b\u767a\u304c\u51fa\u6765\u308b\u72b6\u614b\u3092\u30b4\u30fc\u30eb\u3068\u3057\u307e\u3059\u3002\r\n\uff08Docker\u306e\u57fa\u790e\u77e5\u8b58\u306b\u95a2\u3057\u3066\u306f<a href=\"https:\/\/www.ogis-ri.co.jp\/otc\/hiroba\/technical\/docker\/part1.html\">\u30b3\u30c1\u30e9<\/a>\u306e\u30b5\u30a4\u30c8\u304c\u5206\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\uff09\r\n\r\nDocker\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u306f\u3058\u3081\u3044\u304f\u3064\u304b\u540c\u3058\u3088\u3046\u306a\u4e8b\u3092\u89e3\u8aac\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u304c\u3042\u308a\u307e\u3057\u305f\u304c\u3001\u500b\u4eba\u7684\u306b\u4e0b\u8a18\u306e\u70b9\u304c\u8db3\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\r\n\r\n\u30fb<span class=\"marker_water\">\u753b\u50cf(Media)\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u51fa\u6765\u306a\u3044\u3002<\/span>\r\n\r\n\u30fb<span class=\"marker_water\">PhpMyAdmin\u306a\u3069\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u3067DB(MySQL)\u306b\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u3002\r\n\r\n\u30fb<span class=\"marker_water\">\u30d5\u30a1\u30a4\u30eb\u540c\u671f\u51fa\u6765\u306a\u3044<\/span>(\u30db\u30b9\u30c8PC(\u672c\u4f53)\u3068\u30b2\u30b9\u30c8PC(Docker container)\u3067\u30de\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u304c\u51fa\u6765\u3066\u3044\u306a\u3044\u3002)\r\n\r\n\u3053\u308c\u3089\u304c\u30af\u30ea\u30a2\u30fc\u51fa\u6765\u3066\u3044\u306a\u3044\u3068\u958b\u767a\/\u904b\u7528\u306b\u652f\u969c\u304c\u3042\u308b\u306e\u3067\u8272\u3005\u8abf\u3079\u305f\u7d50\u679c\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\r\n\r\n<h3 class=\"postTitle\">\u524d\u63d0\u74b0\u5883<\/h3>\r\n\u30fbmac OS X 10.9.5\r\n\u30fbdocker-compose \u3092\u4f7f\u3048\u308b\u3002\r\n\r\n<h3 class=\"postTitle\">\u69cb\u7bc9\u624b\u9806<\/h3>\r\n<h4 class=\"postTitleSmall\">1.\u30d7\u30ed\u30b8\u30a7\u30af\u30c8 \u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3002<\/h4>\r\n<p>\r\n\u4eca\u56de\u306f\u4e0b\u8a18\u306e\u30d1\u30b9\u306b\u300cdocker_wp\u300d\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3002\r\n\/Users\/user\/develop\/docker_wp\/\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\">2.\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u79fb\u52d5<\/h4>\r\n<p>\r\n<pre class=\"console\">\r\n> cd \/Users\/user\/develop\/docker_wp\/\r\n<\/pre>\r\n<\/p>\r\n\r\n<h4 class=\"postTitleSmall\">3.\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u306e\u3042\u308bWordPress\u7528Docker image \u3092\u4f5c\u6210<\/h4>\r\n<span class=\"marker_water\">(\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u884c\u3046\u4e8b\u3067Media\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002)<\/span>\r\n\r\n\u30fb\u4e0b\u8a18\u5185\u5bb9\u3067Dockerfile\u3092\u4f5c\u6210\u3002\r\n<pre class=\"code\">\r\nFROM wordpress:latest\r\n\r\nRUN usermod -u 1000 www-data \\\r\n    && groupmod -g 1000 www-data\r\n<\/pre>\r\n\u300cFROM wordpress:latest\u300d\u3068\u3057\u3066\u6700\u65b0\u306eWordPress\u7528image\u3092\u5143\u306b\u3057\u3066\u3044\u307e\u3059\u3002\r\n\r\n\u30fb\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067image\u3092\u4f5c\u6210\r\n<pre class=\"console\">\r\ndocker build -t wordpress:auth .\r\n<\/pre>\r\n\u300cwordpress:auth\u300d\u3067image\u306e\u540d\u524d\u3068\u30bf\u30b0\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\r\n\r\n\u5b9f\u884c\u5f8c\u300cdocker images\u300d\u30b3\u30de\u30f3\u30c9\u3067\u6b63\u5e38\u306bimage\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\r\n\r\n<h4 class=\"postTitleSmall\">4.\u4e0b\u8a18\u5185\u5bb9\u3067docker-compose.yml \u3092\u4f5c\u6210\u3002<\/h4>\r\n\r\n<pre class=\"code\">\r\nversion: '2'\r\n\r\nservices:\r\n   db:\r\n     image: mysql:5.7\r\n     <span style=\"color:red\">ports:\r\n       - \"3306:3306\"<\/span>     \r\n     volumes:\r\n       - db_data:\/var\/lib\/mysql\r\n     restart: always\r\n     environment:\r\n       MYSQL_ROOT_PASSWORD: wordpress\r\n       MYSQL_DATABASE: wordpress\r\n       MYSQL_USER: wordpress\r\n       MYSQL_PASSWORD: wordpress\r\n     privileged: true\r\n\r\n   wordpress:\r\n     depends_on:\r\n       - db\r\n     image: wordpress:auth\r\n     ports:\r\n       - \"80:80\"\r\n     restart: always\r\n     working_dir: \/var\/www\/html\r\n     <span style=\"color:red\">volumes:\r\n       - \/Users\/user\/develop\/docker_wp\/:\/var\/www\/html\/<\/span>\r\n     environment:\r\n       WORDPRESS_DB_HOST: db:3306\r\n       WORDPRESS_DB_PASSWORD: wordpress\r\n     privileged: true\r\nvolumes:\r\n    db_data:\r\n<\/pre>\r\n\r\n\u8d64\u5b57\u306e\u90e8\u5206\u306b\u6ce8\u76ee\u3057\u3066\u9802\u304d\u305f\u3044\u306e\u3067\u3059\u304cdb\u306eport\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3067<span class=\"marker_water\">PhpMyAdmin\u306a\u3069\u306e\u5916\u90e8\u304b\u3089\u306e\u63a5\u7d9a\u304c\u53ef\u80fd<\/span>\u306b\u306a\u308a\u307e\u3059\u3002\r\n\u307e\u305fDB\u306evolumes\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3067<span class=\"marker_water\">\u30db\u30b9\u30c8PC\uff08mac\uff09\u3068docker\u30b3\u30f3\u30c6\u30ca\u30fc\u9593\u306e\u30d5\u30a1\u30a4\u30eb\u540c\u671f\u304c\u53ef\u80fd<\/span>\u3068\u306a\u308a\u307e\u3059\u3002\r\n\r\n<h4 class=\"postTitleSmall\">5.\u30b3\u30f3\u30c6\u30ca\u30fc\u4f5c\u6210\u301c\u7a3c\u50cd<\/h4>\r\n<p>\r\n<pre class=\"console\">\r\ndocker-compose up -d\r\n<\/pre>\r\n\r\n\u5b8c\u4e86\u5f8c\u3001\u300cdocker ps\u300d\u306b\u3066\u4f5c\u6210\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\r\n\u3053\u306e\u3088\u3046\u306b2\u3064\u306e\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\u8d77\u52d5\u3057\u3066\u3044\u308c\u3070OK\u3067\u3059\u3002\r\n\r\n<pre class=\"console\">\r\n>docker ps\r\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES\r\n5a9d3770ee0d        wordpress:auth      \"docker-entrypoint.sh\"   3 minutes ago       Up 3 seconds        0.0.0.0:80->80\/tcp       dockerwp_wordpress_1\r\n3980a9064e38        mysql:5.7           \"docker-entrypoint.sh\"   3 minutes ago       Up 5 seconds        0.0.0.0:3306->3306\/tcp   dockerwp_db_1\r\n<\/pre>\r\n<\/p>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">6.\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b<\/h4>\r\n<p>\r\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u63a5\u7d9a\u5148\u306eIP\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\r\n<pre class=\"console\">\r\ndocker-machine ip\r\n<\/pre>\r\n\r\nhttp:\/\/{IP} \r\nwordpress\u306e\u8a2d\u5b9a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\r\n<img src=\"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/wp-300x199.png\" alt=\"wp\" width=\"300\" height=\"199\" class=\"alignnone size-medium wp-image-2227\" \/>\r\n\r\n<\/p>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">7.DB\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b<\/h4>\r\n\u4eca\u56de\u306fSequel Pro\u3067\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\r\n\r\n<img src=\"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/sequel_pro-300x224.png\" alt=\"sequel_pro\" width=\"300\" height=\"224\" class=\"alignnone size-medium wp-image-2228\" \/>\r\n\r\n\r\n<h4 class=\"postTitleSmall\">8.\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7<\/h4>\r\n<p>\r\n\u958b\u767a\u304c\u5b8c\u4e86\u3057\u305f\u6642\u306a\u3069Docker\u3092\u7d42\u4e86\u3059\u308b\u6642\u306f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u30b3\u30f3\u30c6\u30ca\u30fc\u3092\u524a\u9664\u3057\u307e\u3059\u3002\r\n<pre class=\"console\">\r\ndocker-compose down\r\n<\/pre>\r\n\r\n\u30b3\u30f3\u30c6\u30ca\u30fc\u3092\u524a\u9664\u3057\u3066\u3082DB\u30c7\u30fc\u30bf\u306f\u6b8b\u3063\u3066\u3044\u307e\u3059\u3002\r\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067DB\u30c7\u30fc\u30bf\u3082\u5168\u3066\u524a\u9664\u53ef\u80fd\u3067\u3059\u3002\r\n<pre class=\"console\">\r\ndocker-compose down --volumes\r\n<\/pre>\r\n<\/p>\r\n\r\n\r\n\r\n\r\n<\u53c2\u8003\u30b5\u30a4\u30c8>\r\n<a href=\"https:\/\/docs.docker.com\/compose\/wordpress\/\">https:\/\/docs.docker.com\/compose\/wordpress\/<\/a>\r\n\r\n<a href=\"http:\/\/qiita.com\/suin\/items\/3a0361102af83d0b69aa\">http:\/\/qiita.com\/suin\/items\/3a0361102af83d0b69aa<\/a>","author":"admin","author_name":"admin","author_url":"","date":"December 15, 2016","excerpt":"Docker\u3067WordPress\u5b9f\u884c\u74b0\u5883\u3092\u69cb\u7bc9\u3001\u901a\u5e38\u306e\u958b\u767a\u304c\u51fa\u6765\u308b\u72b6\u614b\u3092\u30b4\u30fc\u30eb\u3068\u3057\u307e\u3059\u3002 \uff08Docker\u306e\u57fa\u790e\u77e5\u8b58\u306b\u95a2\u3057\u3066\u306f\u30b3\u30c1\u30e9\u306e\u30b5\u30a4\u30c8\u304c\u5206\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\uff09 Docker\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u306f\u3058\u3081\u3044\u304f\u3064\u304b\u540c\u3058\u3088\u3046\u306a\u4e8b\u3092\u89e3\u8aac\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u304c\u3042\u308a\u307e\u3057\u305f\u304c\u3001\u500b\u4eba\u7684\u306b\u4e0b\u8a18\u306e\u70b9\u304c\u8db3\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \u30fb\u753b\u50cf(Media)\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u51fa\u6765\u306a\u3044\u3002 \u30fbPhpMyAdmin\u306a\u3069\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u3067DB(MySQL)\u306b\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u3002 \u30fb\u30d5\u30a1\u30a4\u30eb\u540c\u671f\u51fa\u6765\u306a\u3044(\u30db\u30b9\u30c8PC(\u672c\u4f53)\u3068\u30b2\u30b9\u30c8PC(Docker container)\u3067\u30de\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u304c\u51fa\u6765\u3066\u3044\u306a\u3044\u3002) \u3053\u308c\u3089\u304c\u30af\u30ea\u30a2\u30fc\u51fa\u6765\u3066\u3044\u306a\u3044\u3068\u958b\u767a\/\u904b\u7528\u306b\u652f\u969c\u304c\u3042\u308b\u306e\u3067\u8272\u3005\u8abf\u3079\u305f\u7d50\u679c\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002 \u524d\u63d0\u74b0\u5883 \u30fbmac OS X 10.9.5 \u30fbdocker-compose \u3092\u4f7f\u3048\u308b\u3002 \u69cb\u7bc9\u624b\u9806 1.\u30d7\u30ed\u30b8\u30a7\u30af\u30c8 \u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3002 \u4eca\u56de\u306f\u4e0b\u8a18\u306e\u30d1\u30b9\u306b\u300cdocker_wp\u300d\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3002 \/Users\/user\/develop\/docker_wp\/ 2.\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u79fb\u52d5 > cd \/Users\/user\/develop\/docker_wp\/ 3.\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u306e\u3042\u308bWordPress\u7528Docker image \u3092\u4f5c\u6210 (\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u884c\u3046\u4e8b\u3067Media\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002) \u30fb\u4e0b\u8a18\u5185\u5bb9\u3067Dockerfile\u3092\u4f5c\u6210\u3002 FROM wordpress:latest RUN usermod -u 1000 www-data \\ && groupmod -g 1000 www-data \u300cFROM wordpress:latest\u300d\u3068\u3057\u3066\u6700\u65b0\u306eWordPress\u7528image\u3092\u5143\u306b\u3057\u3066\u3044\u307e\u3059\u3002 \u30fb\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067image\u3092\u4f5c\u6210 docker build -t wordpress:auth . \u300cwordpress:auth\u300d\u3067image\u306e\u540d\u524d\u3068\u30bf\u30b0\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002 \u5b9f\u884c\u5f8c\u300cdocker images\u300d\u30b3\u30de\u30f3\u30c9\u3067\u6b63\u5e38\u306bimage\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002 4.\u4e0b\u8a18\u5185\u5bb9\u3067docker-compose.yml \u3092\u4f5c\u6210\u3002 [&hellip;]","modified":"December 16, 2016","category_name":"Develop","category_link":"http:\/\/192.168.99.100:8000\/?cat=147","category_name_0":"Develop","category_link_0":"http:\/\/192.168.99.100:8000\/?cat=147","category_name_1":"Docker","category_link_1":"http:\/\/192.168.99.100:8000\/?cat=149","category_name_2":"Featured","category_link_2":"http:\/\/192.168.99.100:8000\/?cat=3","featured_image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V.jpg","image_thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-150x150.jpg","image_medium":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-300x200.jpg","image_medium_large":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-768x512.jpg","image_large":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-1024x682.jpg","image_newsmag-single-post":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-730x330.jpg","image_newsmag-recent-post-big":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-560x416.jpg","image_newsmag-post-horizontal":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-350x260.jpg","image_newsmag-vertical-post":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-255x195.jpg","image_newsmag-post-grid":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-360x270.jpg","image_newsmag-post-grid-small":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-275x210.jpg","image_newsmag-recent-post-list-image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-65x65.jpg","image_newsmag-slider-image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-1600x600.jpg","image_wp_rp_thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V-150x150.jpg","image":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V.jpg","thumbnail":"http:\/\/192.168.99.100:8000\/wp-content\/uploads\/2016\/12\/MBP9V9A8418_TP_V.jpg","url_label":"View post","tag_1":"docker","tag_2":"","tag_3":"","tag_4":""}]]